#!/bin/bash


# Generate passwd file based on current uid
function generate_passwd_file() {
  USER_ID=$(id -u)
  GROUP_ID=$(id -g)

  if [ x"$USER_ID" != x"0" ]; then

    echo "default:x:${USER_ID}:${GROUP_ID}:Default Application User:${HOME}:/sbin/nologin" >> /etc/passwd

  fi
}

generate_passwd_file

exec /usr/sbin/grafana-server                   \
  --homepath=/usr/share/grafana                 \
  --config=/etc/grafana/grafana.ini             \
  "$@"
